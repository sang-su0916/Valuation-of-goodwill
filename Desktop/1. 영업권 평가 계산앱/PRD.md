# 영업권 평가 시스템 PRD (Product Requirements Document)

## 1. 제품 개요

영업권 평가 시스템은 기업 인수합병(M&A) 및 법인전환 과정에서 발생하는 영업권의 가치를 다양한 방법론을 통해 평가할 수 있는 Streamlit 기반 웹 애플리케이션입니다. 사용자는 직관적인 UI를 통해 필요한 재무 정보를 입력하고, 초과이익법, 현금흐름할인법(DCF), 시장가치비교법을 활용한 영업권 평가 결과를 확인할 수 있습니다.

## 2. 사용자 페르소나

1. **세무사/회계사**
   - 클라이언트에게 M&A 자문 서비스 제공 시 영업권 평가 필요
   - 다양한 평가 방법론에 대한 이해도 보유
   - 정확한 수치와 계산 과정 확인 필요

2. **소규모 기업 경영자**
   - 법인전환이나 사업 매각 시 영업권 가치 평가 필요
   - 전문 지식 부족으로 접근 용이한 도구 필요
   - 결과 해석에 도움이 필요

3. **M&A 컨설턴트**
   - 다양한 기업 가치평가에 활용
   - 복수의 평가 방법을 비교하여 종합적 판단 필요
   - 클라이언트에게 설명 가능한 상세 산출 근거 필요

## 3. 기능 요구사항

### 3.1 핵심 기능

1. **초과이익법 평가**
   - 과거 재무 데이터 기반 정상이익 산출
   - 초과이익 계산 및 현재가치화
   - 산업별 적정 자본수익률 적용
   - `st.number_input`을 활용한 입력 폼 구현
   - `st.expander`로 계산 과정 표시

2. **현금흐름할인법(DCF) 평가**
   - 향후 5개년 현금흐름 예측
   - 적정 할인율 적용
   - 영구성장률 기반 잔존가치 계산
   - `st.slider`로 할인율 및 성장률 설정
   - `st.dataframe`으로 연도별 현금흐름 표시

3. **시장가치비교법 평가**
   - 업종별 P/E, EV/EBITDA 등 다중 배수 적용
   - 동종 업계 평균 대비 가치 산출
   - 최근 M&A 사례 기반 비교 평가
   - `st.selectbox`로 비교 대상 업종 선택
   - `st.radio`로 적용할 배수 지표 선택

4. **종합 평가 및 보고서**
   - 세 가지 방법론 결과 비교 분석
   - 최종 평가액 산출 (가중평균 적용)
   - PDF 형식 보고서 다운로드
   - `st.download_button`으로 보고서 다운로드 기능
   - `plotly`와 `st.plotly_chart`로 평가액 비교 시각화

### 3.2 부가 기능

1. **민감도 분석**
   - 주요 변수(할인율, 성장률 등) 변화에 따른 결과 시뮬레이션
   - 그래프를 통한 시각화
   - `st.session_state`를 활용한 변수 조정과 결과 즉시 반영
   - `st.plotly_chart`로 민감도 히트맵 및 워터폴 차트 구현

2. **데이터 저장 및 불러오기**
   - 평가 정보 저장 및 재활용
   - CSV 형태 데이터 업로드/다운로드
   - `st.file_uploader`와 `st.download_button` 활용
   - `st.session_state`를 통한 세션 데이터 유지

3. **업종별 벤치마크 정보**
   - 국내 주요 업종별 표준 재무비율 참조
   - 최신 시장 데이터 기반 업데이트
   - `@st.cache_data`로 벤치마크 데이터 효율적 로딩
   - `st.dataframe`과 `st.metric`으로 정보 표시

## 4. UI/UX 요구사항

### 4.1 전체 구성

1. **사이드바**
   - `st.sidebar`에 평가 방법 선택 메뉴
   - 기업 정보 입력 섹션
   - 기본 설정 및 도움말
   - `streamlit_option_menu`로 네비게이션 구현

2. **메인 화면**
   - `st.tabs`로 단계별 입력 폼 구성
   - `st.container`로 논리적 섹션 분리
   - 결과 표시 및 시각화
   - 계산 과정 상세 설명

### 4.2 주요 페이지

1. **홈/시작 페이지**
   - `st.page_icon` 및 `st.title`로 브랜딩
   - 시스템 소개 및 사용 방법
   - `st.button`으로 시작하기 버튼 구현
   - `st.markdown`으로 주요 기능 설명

2. **기업 정보 입력**
   - `st.form`과 `st.form_submit_button`으로 일괄 데이터 제출
   - 회사명, 사업자번호, 업종 등 기본 정보
   - 과거 3~5년 재무제표 데이터 입력
   - `st.warning`으로 필수 입력값 검증

3. **평가 설정**
   - `st.columns`로 설정 옵션 그리드 레이아웃
   - 각 방법론별 주요 매개변수 설정
   - 권장값 제공 및 커스터마이징 옵션
   - `st.toggle`로 고급 설정 표시/숨김

4. **결과 페이지**
   - `st.metric`으로 핵심 평가액 하이라이트
   - `st.expander`로 상세 계산 과정 표시
   - `plotly`와 `st.plotly_chart`로 시각화 그래프 및 차트
   - `st.success`로 평가 완료 메시지

5. **보고서 페이지**
   - `st.image`로 최종 보고서 미리보기
   - `st.download_button`으로 PDF 다운로드 옵션
   - `streamlit.components.v1`로 PDF 미리보기 임베딩

## 5. 기술적 요구사항

### 5.1 개발 환경

- **언어**: Python 3.7+
- **프레임워크**: Streamlit 1.18.0+
- **주요 라이브러리**:
  - pandas: 데이터 처리 및 분석
  - numpy: 수학적 계산
  - plotly: 대화형 시각화
  - fpdf/reportlab: PDF 보고서 생성
  - streamlit_option_menu: 향상된 메뉴 구성
  - streamlit-extras: 추가 UI 컴포넌트
  - streamlit-aggrid: 고급 데이터 그리드

### 5.2 데이터 구조

- 사용자 입력 데이터: `st.session_state`에 JSON/Dictionary 형태로 관리
- 업종별 벤치마크 데이터: `@st.cache_data`로 캐싱된 CSV 또는 내장 DataFrame
- 계산 결과: 중간 계산과정 포함 계층적 구조로 `st.session_state`에 저장

### 5.3 성능 요구사항

- 페이지 로딩 시간: 3초 이내
- 계산 처리 시간: 5초 이내 (긴 계산은 `st.spinner` 사용)
- 동시 사용자 지원: 최대 50명
- 모바일 기기 지원: 반응형 UI 구현

### 5.4 Streamlit 최적화

- `@st.cache_data`를 사용하여 데이터 로딩 및 계산 최적화
- `@st.cache_resource`로 모델 및 리소스 효율적 관리
- `st.experimental_rerun()`를 최소화하여 페이지 리로드 최소화
- 복잡한 UI 컴포넌트는 `streamlit.components.v1`으로 커스텀 구현

## 6. 개발 로드맵

### 6.1 Phase 1 (기본 기능)
- 초과이익법 구현
- 기본 UI/UX 설계 (단일 페이지 앱)
- 단일 평가 보고서 생성
- Streamlit Cloud 배포

### 6.2 Phase 2 (확장 기능)
- DCF 및 시장가치비교법 추가
- `st.multipage` 구조로 전환
- `plotly`를 활용한 시각화 기능 강화
- `st.session_state`를 활용한 데이터 저장/불러오기 기능

### 6.3 Phase 3 (고급 기능)
- 민감도 분석 도구
- 업종별 벤치마크 DB 구축
- `streamlit-auth` 활용 사용자 인증 추가
- PDF 보고서 고도화

## 7. 성공 지표

- 월간 활성 사용자: 200명 이상 (Streamlit Analytics 측정)
- 평가 완료율: 방문자 대비 80% 이상
- 사용자 만족도: 4.0/5.0 이상 (st.feedback 컴포넌트로 측정)
- 평가 시간 단축: 기존 수동 방식 대비 70% 이상

## 8. 제약사항 및 고려사항

- Streamlit 환경의 제약사항 고려 (상태 관리, 페이지 간 데이터 전달)
  - `st.session_state`를 활용한 상태 관리
  - 복잡한 상태는 외부 데이터베이스 연동 고려
- 민감한 재무 데이터의 안전한 처리 방안
  - 클라이언트 측 처리 우선
  - 서버 저장 시 암호화 구현
- 사용자 데이터의 임시 저장 및 세션 관리
  - 세션 타임아웃 설정 (기본 1시간)
  - 자동 저장 기능 구현
- 법률/회계 기준 변경에 따른 업데이트 용이성
  - 평가 로직과 UI 분리
  - 계산식 매개변수화 